<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MedAI Vision - Advanced Chest X-Ray Analysis</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-blue: #0066ff;
        --primary-dark: #0047b3;
        --accent-cyan: #00e5ff;
        --accent-purple: #7b68ee;
        --success: #00e676;
        --warning: #ffb300;
        --error: #ff3b57;
        --bg-main: #0a0e1a;
        --bg-secondary: #111827;
        --glass-bg: rgba(17, 24, 39, 0.6);
        --glass-border: rgba(255, 255, 255, 0.08);
        --text-primary: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.75);
        --text-tertiary: rgba(255, 255, 255, 0.5);
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 8px 32px rgba(0, 0, 0, 0.2);
        --shadow-lg: 0 16px 64px rgba(0, 0, 0, 0.3);
        --shadow-glow: 0 0 40px rgba(0, 102, 255, 0.3);
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display",
          "Segoe UI", system-ui, sans-serif;
        background: var(--bg-main);
        color: var(--text-primary);
        overflow-x: hidden;
        min-height: 100vh;
        position: relative;
      }

      /* Animated gradient mesh background */
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        background: radial-gradient(
            circle at 15% 15%,
            rgba(0, 102, 255, 0.15),
            transparent 40%
          ),
          radial-gradient(
            circle at 85% 20%,
            rgba(123, 104, 238, 0.12),
            transparent 45%
          ),
          radial-gradient(
            circle at 50% 80%,
            rgba(0, 229, 255, 0.1),
            transparent 50%
          ),
          radial-gradient(
            circle at 90% 85%,
            rgba(0, 230, 118, 0.08),
            transparent 40%
          );
        animation: mesh-flow 25s ease-in-out infinite;
        z-index: 0;
        pointer-events: none;
      }

      @keyframes mesh-flow {
        0%,
        100% {
          transform: translate(0, 0) scale(1);
          opacity: 1;
        }
        33% {
          transform: translate(-5%, 5%) scale(1.05);
          opacity: 0.9;
        }
        66% {
          transform: translate(5%, -3%) scale(0.98);
          opacity: 0.95;
        }
      }

      /* Floating particles */
      body::after {
        content: "";
        position: fixed;
        inset: 0;
        background-image: radial-gradient(
            2px 2px at 20% 30%,
            rgba(255, 255, 255, 0.15),
            transparent
          ),
          radial-gradient(
            2px 2px at 60% 70%,
            rgba(0, 229, 255, 0.1),
            transparent
          ),
          radial-gradient(
            1px 1px at 50% 50%,
            rgba(255, 255, 255, 0.1),
            transparent
          ),
          radial-gradient(
            1px 1px at 80% 10%,
            rgba(0, 102, 255, 0.15),
            transparent
          );
        background-size: 200px 200px, 180px 180px, 150px 150px, 220px 220px;
        animation: particle-drift 60s linear infinite;
        z-index: 0;
        pointer-events: none;
        opacity: 0.4;
      }

      @keyframes particle-drift {
        0% {
          transform: translate(0, 0);
        }
        100% {
          transform: translate(-50px, 50px);
        }
      }

      .container {
        position: relative;
        z-index: 1;
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* Header with glassmorphism */
      .header {
        background: var(--glass-bg);
        backdrop-filter: blur(24px) saturate(180%);
        border: 1px solid var(--glass-border);
        border-radius: 28px;
        padding: 48px;
        margin-bottom: 32px;
        box-shadow: var(--shadow-lg);
        position: relative;
        overflow: hidden;
        animation: slide-down 0.8s cubic-bezier(0.16, 1, 0.3, 1);
      }

      @keyframes slide-down {
        from {
          transform: translateY(-40px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--primary-blue) 20%,
          var(--accent-cyan) 50%,
          var(--accent-purple) 80%,
          transparent
        );
        animation: shimmer 3s ease-in-out infinite;
      }

      @keyframes shimmer {
        0%,
        100% {
          transform: translateX(-100%);
        }
        50% {
          transform: translateX(100%);
        }
      }

      .header-content {
        display: flex;
        align-items: center;
        gap: 24px;
      }

      .logo-container {
        position: relative;
        width: 80px;
        height: 80px;
      }

      .logo-ring {
        position: absolute;
        inset: 0;
        border: 3px solid;
        border-color: var(--primary-blue) transparent var(--accent-cyan)
          transparent;
        border-radius: 50%;
        animation: rotate 8s linear infinite;
      }

      .logo-ring:nth-child(2) {
        animation-direction: reverse;
        animation-duration: 12s;
        border-color: transparent var(--accent-purple) transparent
          var(--accent-cyan);
      }

      @keyframes rotate {
        to {
          transform: rotate(360deg);
        }
      }

      .logo-icon {
        position: absolute;
        inset: 12px;
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--accent-cyan)
        );
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        box-shadow: 0 8px 24px rgba(0, 102, 255, 0.4);
      }

      .header-text h1 {
        font-size: 42px;
        font-weight: 700;
        background: linear-gradient(
          135deg,
          var(--text-primary),
          var(--accent-cyan)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 8px;
        letter-spacing: -0.5px;
      }

      .header-text p {
        font-size: 18px;
        color: var(--text-secondary);
        font-weight: 400;
      }

      /* Main content grid */
      .main-content {
        flex: 1;
        display: grid;
        grid-template-columns: 1fr;
        gap: 32px;
        animation: fade-in 1s cubic-bezier(0.16, 1, 0.3, 1) 0.3s backwards;
      }

      @keyframes fade-in {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Upload section with premium glass effect */
      .upload-section {
        background: var(--glass-bg);
        backdrop-filter: blur(24px) saturate(180%);
        border: 1px solid var(--glass-border);
        border-radius: 28px;
        padding: 48px;
        box-shadow: var(--shadow-lg);
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      }

      .upload-section:hover {
        border-color: rgba(0, 102, 255, 0.3);
        box-shadow: var(--shadow-glow);
      }

      .upload-area {
        position: relative;
        border: 2px dashed var(--glass-border);
        border-radius: 20px;
        padding: 80px 40px;
        text-align: center;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        background: rgba(0, 0, 0, 0.2);
        overflow: hidden;
      }

      .upload-area::before {
        content: "";
        position: absolute;
        inset: -2px;
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--accent-cyan),
          var(--accent-purple)
        );
        border-radius: 20px;
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: -1;
      }

      .upload-area:hover::before {
        opacity: 0.1;
      }

      .upload-area:hover {
        border-color: var(--primary-blue);
        background: rgba(0, 102, 255, 0.05);
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(0, 102, 255, 0.2);
      }

      .upload-area.dragover {
        border-color: var(--accent-cyan);
        background: rgba(0, 229, 255, 0.08);
        transform: scale(1.02);
      }

      .upload-icon {
        font-size: 72px;
        margin-bottom: 24px;
        animation: float 3s ease-in-out infinite;
        filter: drop-shadow(0 8px 16px rgba(0, 102, 255, 0.3));
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-12px);
        }
      }

      .upload-text {
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 12px;
        color: var(--text-primary);
      }

      .upload-subtext {
        font-size: 16px;
        color: var(--text-tertiary);
        margin-bottom: 8px;
      }

      #fileInput {
        display: none;
      }

      /* Premium button with magnetic hover effect */
      .upload-button {
        position: relative;
        margin-top: 32px;
        padding: 18px 48px;
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--primary-dark)
        );
        border: none;
        border-radius: 16px;
        cursor: pointer;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        box-shadow: 0 8px 24px rgba(0, 102, 255, 0.3);
      }

      .upload-button::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          var(--accent-cyan),
          var(--accent-purple)
        );
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .upload-button:hover::before {
        opacity: 1;
      }

      .upload-button:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 16px 48px rgba(0, 102, 255, 0.5);
      }

      .upload-button:active {
        transform: translateY(0) scale(0.98);
      }

      .upload-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .upload-button span {
        position: relative;
        z-index: 1;
      }

      /* Loading animation */
      .loading {
        display: none;
        text-align: center;
        padding: 64px 48px;
        background: var(--glass-bg);
        backdrop-filter: blur(24px) saturate(180%);
        border: 1px solid var(--glass-border);
        border-radius: 28px;
        box-shadow: var(--shadow-lg);
      }

      .loading.active {
        display: block;
        animation: fade-in 0.5s ease;
      }

      .spinner-container {
        position: relative;
        width: 120px;
        height: 120px;
        margin: 0 auto 32px;
      }

      .spinner {
        position: absolute;
        inset: 0;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
      }

      .spinner-inner {
        position: absolute;
        inset: 8px;
        border: 4px solid transparent;
        border-top-color: var(--primary-blue);
        border-right-color: var(--accent-cyan);
        border-radius: 50%;
        animation: spin 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
      }

      .spinner-outer {
        position: absolute;
        inset: -4px;
        border: 3px solid transparent;
        border-top-color: var(--accent-purple);
        border-left-color: var(--accent-cyan);
        border-radius: 50%;
        animation: spin 2s cubic-bezier(0.5, 0, 0.5, 1) infinite reverse;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        font-size: 22px;
        font-weight: 600;
        margin-bottom: 12px;
        color: var(--text-primary);
      }

      .loading-subtext {
        font-size: 16px;
        color: var(--text-tertiary);
      }

      /* Progress bar */
      .progress-bar {
        width: 100%;
        height: 6px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
        margin-top: 24px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--primary-blue),
          var(--accent-cyan)
        );
        border-radius: 3px;
        animation: progress 2s ease-in-out infinite;
      }

      @keyframes progress {
        0% {
          width: 0%;
        }
        50% {
          width: 70%;
        }
        100% {
          width: 100%;
        }
      }

      /* Error message */
      .error {
        display: none;
        background: linear-gradient(
          135deg,
          rgba(255, 59, 87, 0.15),
          rgba(255, 59, 87, 0.05)
        );
        border: 1px solid rgba(255, 59, 87, 0.3);
        border-radius: 16px;
        padding: 20px 24px;
        margin-bottom: 24px;
        color: var(--error);
        font-weight: 500;
        backdrop-filter: blur(12px);
        animation: shake 0.5s ease;
      }

      .error.active {
        display: block;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      /* Results section with stunning cards */
      .result-section {
        display: none;
        animation: scale-in 0.6s cubic-bezier(0.16, 1, 0.3, 1);
      }

      .result-section.active {
        display: block;
      }

      @keyframes scale-in {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .result-card {
        background: var(--glass-bg);
        backdrop-filter: blur(24px) saturate(180%);
        border: 1px solid var(--glass-border);
        border-radius: 28px;
        padding: 48px;
        box-shadow: var(--shadow-lg);
        position: relative;
        overflow: hidden;
      }

      .result-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-blue),
          var(--accent-cyan),
          var(--accent-purple)
        );
      }

      .result-card.result-normal::before {
        background: linear-gradient(90deg, var(--success), #00c853);
      }

      .result-card.result-pneumonia::before {
        background: linear-gradient(90deg, var(--error), #ff1744);
      }

      .result-header {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 32px;
      }

      .result-icon {
        width: 72px;
        height: 72px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 36px;
        background: linear-gradient(
          135deg,
          rgba(0, 102, 255, 0.2),
          rgba(0, 229, 255, 0.1)
        );
        box-shadow: 0 8px 24px rgba(0, 102, 255, 0.3);
      }

      .result-icon.normal {
        background: linear-gradient(
          135deg,
          rgba(0, 230, 118, 0.2),
          rgba(0, 200, 83, 0.1)
        );
        box-shadow: 0 8px 24px rgba(0, 230, 118, 0.3);
      }

      .result-icon.pneumonia {
        background: linear-gradient(
          135deg,
          rgba(255, 59, 87, 0.2),
          rgba(255, 23, 68, 0.1)
        );
        box-shadow: 0 8px 24px rgba(255, 59, 87, 0.3);
      }

      .result-title {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 8px;
      }

      .result-confidence {
        font-size: 20px;
        color: var(--text-secondary);
        font-weight: 500;
      }

      .confidence-badge {
        display: inline-block;
        padding: 6px 16px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 18px;
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--accent-cyan)
        );
        color: var(--text-primary);
        margin-left: 8px;
      }

      /* Probability cards grid */
      .probabilities {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 24px;
        margin: 32px 0;
      }

      .prob-item {
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(12px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 32px;
        text-align: center;
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
        overflow: hidden;
      }

      .prob-item::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          rgba(0, 102, 255, 0.1),
          transparent
        );
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .prob-item:hover::before {
        opacity: 1;
      }

      .prob-item:hover {
        transform: translateY(-4px);
        border-color: var(--primary-blue);
        box-shadow: 0 12px 32px rgba(0, 102, 255, 0.2);
      }

      .prob-label {
        font-size: 16px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--text-tertiary);
        margin-bottom: 16px;
      }

      .prob-value {
        font-size: 48px;
        font-weight: 700;
        line-height: 1;
        position: relative;
      }

      .prob-normal {
        background: linear-gradient(135deg, var(--success), #00c853);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .prob-pneumonia {
        background: linear-gradient(135deg, var(--error), #ff1744);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Circular progress indicator */
      .prob-circle {
        width: 120px;
        height: 120px;
        margin: 0 auto 20px;
        position: relative;
      }

      .prob-circle svg {
        transform: rotate(-90deg);
      }

      .prob-circle-bg {
        fill: none;
        stroke: rgba(255, 255, 255, 0.1);
        stroke-width: 8;
      }

      .prob-circle-fill {
        fill: none;
        stroke-width: 8;
        stroke-linecap: round;
        transition: stroke-dashoffset 1s ease;
      }

      .prob-circle-fill.normal {
        stroke: url(#gradient-normal);
      }

      .prob-circle-fill.pneumonia {
        stroke: url(#gradient-pneumonia);
      }

      .prob-circle-text {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: 700;
      }

      /* Result details card */
      .result-details {
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(12px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 32px;
        margin-top: 32px;
        line-height: 1.8;
        color: var(--text-secondary);
        font-size: 16px;
        position: relative;
      }

      .result-details::before {
        content: "💡";
        position: absolute;
        top: -16px;
        left: 32px;
        font-size: 32px;
        background: var(--bg-secondary);
        padding: 0 12px;
      }

      /* Action buttons */
      .action-buttons {
        display: flex;
        gap: 16px;
        margin-top: 32px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 16px 32px;
        font-size: 16px;
        font-weight: 600;
        border: none;
        border-radius: 14px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
        overflow: hidden;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--primary-dark)
        );
        color: var(--text-primary);
        box-shadow: 0 8px 24px rgba(0, 102, 255, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 32px rgba(0, 102, 255, 0.4);
      }

      .btn-secondary {
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--glass-border);
        color: var(--text-primary);
        backdrop-filter: blur(12px);
      }

      .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.12);
        border-color: var(--primary-blue);
      }

      /* Footer with disclaimer */
      .footer {
        margin-top: 48px;
        padding: 32px;
        text-align: center;
        background: var(--glass-bg);
        backdrop-filter: blur(24px) saturate(180%);
        border: 1px solid var(--glass-border);
        border-radius: 28px;
        animation: fade-in 1s ease 0.6s backwards;
      }

      .disclaimer {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        padding: 16px 24px;
        background: rgba(255, 179, 0, 0.1);
        border: 1px solid rgba(255, 179, 0, 0.3);
        border-radius: 16px;
        color: var(--warning);
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 16px;
      }

      .footer-text {
        color: var(--text-tertiary);
        font-size: 14px;
        line-height: 1.6;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .container {
          padding: 16px;
        }

        .header {
          padding: 32px 24px;
          border-radius: 20px;
        }

        .header-content {
          flex-direction: column;
          text-align: center;
        }

        .header-text h1 {
          font-size: 32px;
        }

        .header-text p {
          font-size: 16px;
        }

        .upload-section,
        .result-card {
          padding: 32px 24px;
          border-radius: 20px;
        }

        .upload-area {
          padding: 48px 24px;
        }

        .upload-icon {
          font-size: 56px;
        }

        .upload-text {
          font-size: 22px;
        }

        .result-title {
          font-size: 24px;
        }

        .prob-value {
          font-size: 36px;
        }

        .probabilities {
          grid-template-columns: 1fr;
        }

        .action-buttons {
          flex-direction: column;
        }

        .btn {
          width: 100%;
        }
      }

      /* Utility animations */
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
      }

      .pulse {
        animation: pulse 2s ease-in-out infinite;
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 12px;
      }

      ::-webkit-scrollbar-track {
        background: var(--bg-secondary);
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(
          180deg,
          var(--primary-blue),
          var(--accent-cyan)
        );
        border-radius: 6px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(
          180deg,
          var(--accent-cyan),
          var(--accent-purple)
        );
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <div class="header-content">
          <div class="logo-container">
            <div class="logo-ring"></div>
            <div class="logo-ring"></div>
            <div class="logo-icon">🫁</div>
          </div>
          <div class="header-text">
            <h1>MedAI Vision</h1>
            <p>Advanced AI-Powered Chest X-Ray Analysis System</p>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Upload Section -->
        <div class="upload-section">
          <div
            class="upload-area"
            onclick="document.getElementById('fileInput').click()"
          >
            <div class="upload-icon">🔬</div>
            <div class="upload-text">Drop your X-ray image here</div>
            <div class="upload-subtext">or click to browse files</div>
            <div class="upload-subtext">Supports PNG, JPG, JPEG • Max 16MB</div>
          </div>

          <input type="file" id="fileInput" accept="image/*" />
          <button
            class="upload-button"
            onclick="uploadFile()"
            id="uploadBtn"
            disabled
          >
            <span>🔬 Analyze X-Ray</span>
          </button>
        </div>

        <!-- Error Message -->
        <div class="error" id="errorSection"></div>

        <!-- Loading Section -->
        <div class="loading" id="loadingSection">
          <div class="spinner-container">
            <div class="spinner"></div>
            <div class="spinner-inner"></div>
            <div class="spinner-outer"></div>
          </div>
          <div class="loading-text">Analyzing X-Ray Image</div>
          <div class="loading-subtext">
            AI processing in progress • This may take a few seconds
          </div>
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
        </div>

        <!-- Result Section -->
        <div class="result-section" id="resultSection">
          <div class="result-card" id="resultCard">
            <div class="result-header">
              <div class="result-icon" id="resultIcon">✅</div>
              <div>
                <div class="result-title" id="resultTitle">
                  Analysis Complete
                </div>
                <div class="result-confidence" id="resultConfidence">
                  Confidence:
                  <span class="confidence-badge" id="confidenceBadge">--</span>
                </div>
              </div>
            </div>

            <!-- Probability Visualization -->
            <div class="probabilities">
              <div class="prob-item">
                <div class="prob-circle">
                  <svg width="120" height="120">
                    <defs>
                      <linearGradient
                        id="gradient-normal"
                        x1="0%"
                        y1="0%"
                        x2="100%"
                        y2="100%"
                      >
                        <stop offset="0%" style="stop-color: #00e676" />
                        <stop offset="100%" style="stop-color: #00c853" />
                      </linearGradient>
                    </defs>
                    <circle
                      class="prob-circle-bg"
                      cx="60"
                      cy="60"
                      r="52"
                    ></circle>
                    <circle
                      class="prob-circle-fill normal"
                      id="normalCircle"
                      cx="60"
                      cy="60"
                      r="52"
                      stroke-dasharray="327"
                      stroke-dashoffset="327"
                    ></circle>
                  </svg>
                  <div
                    class="prob-circle-text prob-normal"
                    id="normalCircleText"
                  >
                    0%
                  </div>
                </div>
                <div class="prob-label">Normal</div>
                <div class="prob-value prob-normal" id="normalProb">--</div>
              </div>

              <div class="prob-item">
                <div class="prob-circle">
                  <svg width="120" height="120">
                    <defs>
                      <linearGradient
                        id="gradient-pneumonia"
                        x1="0%"
                        y1="0%"
                        x2="100%"
                        y2="100%"
                      >
                        <stop offset="0%" style="stop-color: #ff3b57" />
                        <stop offset="100%" style="stop-color: #ff1744" />
                      </linearGradient>
                    </defs>
                    <circle
                      class="prob-circle-bg"
                      cx="60"
                      cy="60"
                      r="52"
                    ></circle>
                    <circle
                      class="prob-circle-fill pneumonia"
                      id="pneumoniaCircle"
                      cx="60"
                      cy="60"
                      r="52"
                      stroke-dasharray="327"
                      stroke-dashoffset="327"
                    ></circle>
                  </svg>
                  <div
                    class="prob-circle-text prob-pneumonia"
                    id="pneumoniaCircleText"
                  >
                    0%
                  </div>
                </div>
                <div class="prob-label">Pneumonia</div>
                <div class="prob-value prob-pneumonia" id="pneumoniaProb">
                  --
                </div>
              </div>
            </div>

            <!-- Result Details -->
            <div class="result-details" id="resultDetails">
              AI analysis completed successfully. Please review the results
              above.
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
              <button class="btn btn-primary" onclick="resetForm()">
                🔄 Analyze Another X-Ray
              </button>
              <button class="btn btn-secondary" onclick="downloadReport()">
                📄 Download Report
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="footer">
        <div class="disclaimer">
          <span>⚠️</span>
          <span
            >Medical AI Tool - For Educational & Research Purposes Only</span
          >
        </div>
        <p class="footer-text">
          This AI-powered analysis is designed to assist healthcare
          professionals and should not replace professional medical diagnosis.
          Always consult with qualified healthcare providers for medical
          decisions and treatment plans.
        </p>
      </div>
    </div>

    <script>
      let selectedFile = null;

      // File input handling
      document
        .getElementById("fileInput")
        .addEventListener("change", function (e) {
          selectedFile = e.target.files[0];
          if (selectedFile) {
            document.getElementById("uploadBtn").disabled = false;
            updateUploadArea(`✓ Selected: ${selectedFile.name}`);
          }
        });

      // Drag and drop handling
      const uploadArea = document.querySelector(".upload-area");

      uploadArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        uploadArea.classList.add("dragover");
      });

      uploadArea.addEventListener("dragleave", () => {
        uploadArea.classList.remove("dragover");
      });

      uploadArea.addEventListener("drop", (e) => {
        e.preventDefault();
        uploadArea.classList.remove("dragover");

        const files = e.dataTransfer.files;
        if (files.length > 0) {
          selectedFile = files[0];
          document.getElementById("fileInput").files = files;
          document.getElementById("uploadBtn").disabled = false;
          updateUploadArea(`✓ Selected: ${selectedFile.name}`);
        }
      });

      function updateUploadArea(text) {
        const uploadText = document.querySelector(".upload-text");
        uploadText.textContent = text;
      }

      function uploadFile() {
        if (!selectedFile) {
          showError("Please select a file first");
          return;
        }

        // Hide upload section
        document.querySelector(".upload-section").style.display = "none";

        // Show loading
        const loadingSection = document.getElementById("loadingSection");
        loadingSection.classList.add("active");

        // Hide error and result
        document.getElementById("errorSection").classList.remove("active");
        document.getElementById("resultSection").classList.remove("active");

        // Create form data
        const formData = new FormData();
        formData.append("file", selectedFile);

        // Upload and analyze
        fetch("/upload", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            console.log("Backend response:", data);

            loadingSection.classList.remove("active");

            if (data.status === "error" || data.error) {
              showError(data.error || "Analysis failed");
              document.querySelector(".upload-section").style.display = "block";
            } else {
              showResult(data);
            }
          })
          .catch((error) => {
            console.error("Upload error:", error);
            loadingSection.classList.remove("active");
            showError("Upload failed: " + error.message);
            document.querySelector(".upload-section").style.display = "block";
          });
      }

      function showResult(data) {
        const resultSection = document.getElementById("resultSection");
        const resultCard = document.getElementById("resultCard");

        // Extract prediction type
        let predictionType = "normal";
        let predictionText = data.prediction || "Analysis completed";

        if (predictionText.toLowerCase().includes("pneumonia")) {
          predictionType = "pneumonia";
        }

        // Update card styling
        resultCard.className = `result-card result-${predictionType}`;

        // Update icon
        const resultIcon = document.getElementById("resultIcon");
        resultIcon.className = `result-icon ${predictionType}`;
        resultIcon.textContent = predictionType === "pneumonia" ? "⚠️" : "✅";

        // Update title
        document.getElementById("resultTitle").textContent = predictionText;

        // Extract and display confidence
        let confidenceValue = data.confidence || "0%";
        let confidenceNum = parseFloat(confidenceValue.replace("%", "")) || 0;

        document.getElementById("confidenceBadge").textContent =
          confidenceValue;

        // Calculate probabilities
        let normalProb, pneumoniaProb;

        if (predictionType === "pneumonia") {
          pneumoniaProb = confidenceNum;
          normalProb = 100 - confidenceNum;
        } else {
          normalProb = confidenceNum;
          pneumoniaProb = 100 - confidenceNum;
        }

        // Update probability displays
        document.getElementById(
          "normalProb"
        ).textContent = `${normalProb.toFixed(1)}%`;
        document.getElementById(
          "pneumoniaProb"
        ).textContent = `${pneumoniaProb.toFixed(1)}%`;

        // Update circular progress bars
        updateCircularProgress("normalCircle", "normalCircleText", normalProb);
        updateCircularProgress(
          "pneumoniaCircle",
          "pneumoniaCircleText",
          pneumoniaProb
        );

        // Update details
        let details = "🔬 AI Analysis Results:\n\n";
        if (predictionType === "pneumonia") {
          details +=
            "⚠️ Potential signs of pneumonia detected in the X-ray image. This requires immediate attention from a healthcare professional. ";
          details +=
            "Please consult with a radiologist or physician for proper diagnosis and treatment planning.";
        } else {
          details +=
            "✅ The X-ray analysis indicates normal chest findings with no obvious abnormalities detected. ";
          details +=
            "However, this AI analysis should be confirmed by a qualified healthcare professional for comprehensive evaluation.";
        }

        document.getElementById("resultDetails").textContent = details;

        // Show result section with animation
        resultSection.classList.add("active");
      }

      function updateCircularProgress(circleId, textId, percentage) {
        const circle = document.getElementById(circleId);
        const text = document.getElementById(textId);
        const circumference = 327;
        const offset = circumference - (percentage / 100) * circumference;

        setTimeout(() => {
          circle.style.strokeDashoffset = offset;
          text.textContent = `${percentage.toFixed(0)}%`;
        }, 100);
      }

      function showError(message) {
        const errorSection = document.getElementById("errorSection");
        errorSection.textContent = "❌ " + message;
        errorSection.classList.add("active");

        setTimeout(() => {
          errorSection.classList.remove("active");
        }, 5000);
      }

      function resetForm() {
        selectedFile = null;
        document.getElementById("fileInput").value = "";
        document.getElementById("uploadBtn").disabled = true;
        document.querySelector(".upload-text").textContent =
          "Drop your X-ray image here";

        document.querySelector(".upload-section").style.display = "block";
        document.getElementById("loadingSection").classList.remove("active");
        document.getElementById("errorSection").classList.remove("active");
        document.getElementById("resultSection").classList.remove("active");

        // Reset circular progress
        document.getElementById("normalCircle").style.strokeDashoffset = "327";
        document.getElementById("pneumoniaCircle").style.strokeDashoffset =
          "327";
      }

      function downloadReport() {
        // Get the results
        const title = document.getElementById("resultTitle").textContent;
        const confidence =
          document.getElementById("confidenceBadge").textContent;
        const normalProb = document.getElementById("normalProb").textContent;
        const pneumoniaProb =
          document.getElementById("pneumoniaProb").textContent;
        const details = document.getElementById("resultDetails").textContent;

        // Create report content
        const reportContent = `
MedAI Vision - Chest X-Ray Analysis Report
==========================================

Analysis Date: ${new Date().toLocaleString()}
File: ${selectedFile ? selectedFile.name : "N/A"}

RESULTS
-------
${title}
Confidence Level: ${confidence}

PROBABILITY BREAKDOWN
--------------------
Normal: ${normalProb}
Pneumonia: ${pneumoniaProb}

DETAILED ANALYSIS
-----------------
${details}

DISCLAIMER
----------
This AI-powered analysis is for educational and research purposes only. 
It should not replace professional medical diagnosis. Always consult with 
qualified healthcare providers for medical decisions and treatment plans.

Generated by MedAI Vision - Advanced AI-Powered Medical Imaging Analysis
            `.trim();

        // Create and download file
        const blob = new Blob([reportContent], { type: "text/plain" });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `MedAI_Report_${new Date().getTime()}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }

      // Add keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          resetForm();
        }
      });
    </script>
  </body>
</html>
